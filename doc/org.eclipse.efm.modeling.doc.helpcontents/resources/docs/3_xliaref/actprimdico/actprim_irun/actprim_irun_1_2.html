<html>
<body>


<h1>Fiddling with a composite state's "@irun{...}" : simple case</h1>

<h2>Theory</h2>
<p>When we have a composite state :</p>
<ul>
<li>with substates (of course because it is a composite state)</li>
<li>with NO outgoing transitions</li>
</ul>
<p>When we implement the @irun{...} activity primitive and we put an instruction "action();" inside such as below :</p>
<img src="images/irun_1_2_t001.png" width=500, border="3">
<p>The XLIA compiler interprets it as in the following :</p>
<img src="images/irun_1_2_t002.png" width=500, border="3">
<p>Which is equivalent to :</p>
<img src="images/irun_1_2_t003.png" width=500, border="3">

<h2>Hypothesis</h2>
<p>We must consider a composite state :</p>
<ul>
<li>with substates (of course because it is a composite state)</li>
<li>with NO outgoing transitions (i.e. NO transitions are defined in the body of the composite state (but transitions can be defined in the body of substates))</li>
</ul>

<h2>Example Application</h2>

<p>The following example is that of a batch of dirty clothes that is being washed. The clothes go through several states and substates as follows :</p>
<ul>
<li>being in the washing machine :
	<ul>
	<li>a "prewash" substate</li>
	<li>a "wash" substate</li>
	<li>a "spindry" substate</li>
	</ul>
</li>
<li>being in the dryer :
	<ul>
	<li>a "airdry" substate</li>
	<li>a "ironing" substate</li>
	</ul>
</li>
</ul>
<p>The XLIA code is the following :</p>
<img src="images/irun_1_2_001.png" width=800, border="3">

<p>We've been using the "@irun{...}" of the "inWashingMachine" composite state and of the "inDryer" composite state. What happens is that before evaluating the transitions of the substates, the instructions inside the parent composite state's "@irun{...}" are executed.</p>
<p>Therefore, the previous code is equivalent to :</p>
<img src="images/irun_1_2_002.png" width=700, border="3">

<p>Or again to :</p>
<img src="images/irun_1_2_003.png" width=700, border="3">

<p>When executing an symbolic exploration, we notice that for each evaluation step, the consumption for the current machine the Clothes are being in is updated :</p>
<img src="images/irun_1_2_004.png" width=1100, border="3">

<p>This use of the "@irun{...}" activity primitive allows code factorization in XLIA.</p>
<p></p>



</body>
</html>